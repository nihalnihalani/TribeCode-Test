{% extends "base.html" %}

{% block content %}
<div class="header-bar">
    <h1 class="page-title">Dashboard</h1>
    <a href="/scout" class="btn btn-primary">
        <img src="https://img.icons8.com/?id=WwWusvLMTFd7&format=png&size=24" style="width:16px; margin-right:8px; filter: invert(1);">
        New Scan
    </a>
</div>

<!-- Key Metrics -->
<div class="stats-grid">
    <div class="stat-card">
        <span class="stat-label">Total Archived</span>
        <span class="stat-value">{{ stats.total }}</span>
    </div>
    <div class="stat-card" style="border-bottom: 4px solid #ff4500;">
        <span class="stat-label">Reddit Posts</span>
        <span class="stat-value">{{ stats.reddit }}</span>
    </div>
    <div class="stat-card" style="border-bottom: 4px solid #1da1f2;">
        <span class="stat-label">Twitter/X Posts</span>
        <span class="stat-value">{{ stats.twitter }}</span>
    </div>
</div>

<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
    <!-- Recent Activity Feed -->
    <div class="card">
        <div class="header-bar" style="margin-bottom: 1rem;">
            <h3 style="margin:0;">Recent Pulse</h3>
            <a href="/interactions" style="color: var(--primary-color); text-decoration: none; font-weight: 600; font-size: 0.875rem;">View Feed &rarr;</a>
        </div>
        
        <div class="feed-preview">
            {% for interaction in interactions %}
            <div style="padding: 1rem 0; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center;">
                <div style="width: 8px; height: 8px; border-radius: 50%; background: {{ '#ff4500' if interaction.platform == 'Reddit' else '#1da1f2' }}; margin-right: 1rem;"></div>
                <div style="flex-grow: 1;">
                    <div style="font-weight: 600; font-size: 0.9rem;">{{ interaction.post_content[:60] }}...</div>
                    <div style="font-size: 0.75rem; color: #64748b;">{{ interaction.created_at.strftime('%b %d, %H:%M') }} â€¢ {{ interaction.platform }}</div>
                </div>
            </div>
            {% else %}
            <p style="color: #94a3b8; text-align: center; padding: 2rem;">No recent activity. Launch a scan!</p>
            {% endfor %}
        </div>
    </div>

    <!-- Chart (Placeholder for now) -->
    <div class="card">
        <h3 style="margin-top:0;">Platform Distribution</h3>
        <canvas id="platformChart"></canvas>
    </div>
</div>

<script>
    // Initialize Chart
    const ctx = document.getElementById('platformChart').getContext('2d');
    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Reddit', 'Twitter'],
            datasets: [{
                data: [{{ stats.reddit }}, {{ stats.twitter }}],
                backgroundColor: ['#ff4500', '#1da1f2'],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'bottom' }
            }
        }
    });
</script>
{% endblock %}
